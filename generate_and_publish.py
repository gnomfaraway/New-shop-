<PUT THE FINAL PYTHON SCRIPT HERE - shortened for brevity>